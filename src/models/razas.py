#!/usr/bin/env python3# -*- coding: utf-8 -*-"""Sistema de Razas para The Witcher TRPGBasado en los manuales oficiales en españolVersión 1.0.0"""from dataclasses import dataclass, fieldfrom typing import Dict, List, Optionalfrom enum import Enumclass TipoRaza(Enum):    """Tipos de razas jugables"""    HUMANO = "Humano"    ELFO = "Elfo"    ENANO = "Enano"    BRUJO = "Brujo"    MEDIANO = "Mediano"    VRAN = "Vran"    GNOMO = "Gnomo"    BOBOLACO = "Bobolaco"class Territorio(Enum):    """Territorios del Continente"""    EL_NORTE = "El Norte"    NILFGAARD = "Nilfgaard"    SKELLIGE = "Skellige"    DOL_BLATHANNA = "Dol Blathanna"    MAHAKAM = "Mahakam"class EstatusSocial(Enum):    """Estatus social en diferentes territorios"""    ODIADO = "Odiado"    ODIADO_Y_TEMIDO = "Odiado y Temido"    TOLERADO = "Tolerado"    TOLERADO_Y_TEMIDO = "Tolerado y Temido"    SEMEJANTE = "Semejante"@dataclassclass VentajaRacial:    """Ventaja racial específica"""    nombre: str    descripcion: str    bonificadores: Dict[str, int] = field(default_factory=dict)    habilidad_especial: str = ""@dataclassclass Raza:    """Clase base para todas las razas"""    nombre: str    tipo: TipoRaza    descripcion: str    ventajas: List[VentajaRacial]    restricciones: List[str] = field(default_factory=list)    estatus_social: Dict[Territorio, EstatusSocial] = field(default_factory=dict)    ruta_imagen: str = ""        def aplicar_bonificadores(self, estadisticas: Dict) -> Dict:        """Aplica los bonificadores raciales a las estadísticas"""        stats = estadisticas.copy()        for ventaja in self.ventajas:            for stat, bonus in ventaja.bonificadores.items():                if stat in stats:                    stats[stat] += bonus        return stats        def obtener_estatus_social(self, territorio: Territorio) -> EstatusSocial:        """Obtiene el estatus social en un territorio específico"""        return self.estatus_social.get(territorio, EstatusSocial.TOLERADO)# ============================================================================# DEFINICIÓN DE TODAS LAS RAZAS# ============================================================================# HUMANOHUMANO = Raza(    nombre="Humano",    tipo=TipoRaza.HUMANO,    descripcion="Los humanos son la raza más numerosa del Continente, versátiles y adaptables.",    ventajas=[        VentajaRacial(            nombre="Fiable",            descripcion="Bonificador innato de +1 a Carisma, Seducción y Persuasión dirigidas a otros humanos",            bonificadores={"Carisma": 1, "Seducción": 1, "Persuasión": 1},            habilidad_especial="Bonos solo contra otros humanos"        ),        VentajaRacial(            nombre="Ingenioso",            descripcion="Bonificador innato de +1 a Deducción",            bonificadores={"Deducción": 1}        ),        VentajaRacial(            nombre="Testarudo",            descripcion="Tres veces por sesión puede repetir una tirada fallida de Coraje o Resistir Coacción y aplicar el mejor resultado. No puede usar esta capacidad más de una vez en la misma tirada.",            habilidad_especial="Repetir tiradas de Coraje/Resistir Coacción (3/sesión)"        )    ],    estatus_social={        Territorio.EL_NORTE: EstatusSocial.SEMEJANTE,        Territorio.NILFGAARD: EstatusSocial.SEMEJANTE,        Territorio.SKELLIGE: EstatusSocial.SEMEJANTE,        Territorio.DOL_BLATHANNA: EstatusSocial.ODIADO,        Territorio.MAHAKAM: EstatusSocial.TOLERADO    },    ruta_imagen="assets/images/razas/humano.png")# ELFOELFO = Raza(    nombre="Elfo (Aen Seidhe)",    tipo=TipoRaza.ELFO,    descripcion="Los elfos son los habitantes originales del Continente, con gran afinidad por la naturaleza y las artes.",    ventajas=[        VentajaRacial(            nombre="Artístico",            descripcion="Bonificador innato de +1 a Bellas Artes",            bonificadores={"Bellas Artes": 1}        ),        VentajaRacial(            nombre="Sintonía con la Naturaleza",            descripcion="Cualquier bestia se considera amistosa y no les atacará salvo que la provoquen. Encuentran automáticamente cualquier sustancia vegetal cuya disponibilidad sea Común o Universal que estén buscando, siempre que se encuentre de forma natural en la zona",            habilidad_especial="Bestias amistosas, encuentra sustancias vegetales Comunes/Universales automáticamente"        ),        VentajaRacial(            nombre="Tirador",            descripcion="Bonificador innato de +2 a Arco. Pueden empuñar y encordar un arco sin que les cueste una acción",            bonificadores={"Arco": 2},            habilidad_especial="Encordar arco sin acción"        )    ],    estatus_social={        Territorio.EL_NORTE: EstatusSocial.ODIADO_Y_TEMIDO,        Territorio.NILFGAARD: EstatusSocial.TOLERADO,        Territorio.SKELLIGE: EstatusSocial.ODIADO_Y_TEMIDO,        Territorio.DOL_BLATHANNA: EstatusSocial.SEMEJANTE,        Territorio.MAHAKAM: EstatusSocial.SEMEJANTE    },    ruta_imagen="assets/images/razas/elfo.png")# ENANOENANO = Raza(    nombre="Enano",    tipo=TipoRaza.ENANO,    descripcion="Los enanos son resistentes y fuertes, maestros artesanos y comerciantes astutos.",    ventajas=[        VentajaRacial(            nombre="Duro",            descripcion="La piel de los enanos tiene una Capacidad de Parada de 2. Esta CP no se puede reducir con ataques de armas ni daño ablativo, y se considera una capa de armadura que se combina con otras que pueda llevar el personaje",            habilidad_especial="CP 2 natural (no reducible, acumulable con armadura)"        ),        VentajaRacial(            nombre="Fuerte",            descripcion="Bonificador innato de +1 a Proezas de Fuerza y su Estorbo aumenta en 25",            bonificadores={"Proezas de Fuerza": 1, "Estorbo": 25}        ),        VentajaRacial(            nombre="Ojo de Artesano",            descripcion="Bonificador innato de +1 a Negociar",            bonificadores={"Negociar": 1}        )    ],    estatus_social={        Territorio.EL_NORTE: EstatusSocial.TOLERADO,        Territorio.NILFGAARD: EstatusSocial.SEMEJANTE,        Territorio.SKELLIGE: EstatusSocial.TOLERADO,        Territorio.DOL_BLATHANNA: EstatusSocial.ODIADO,        Territorio.MAHAKAM: EstatusSocial.SEMEJANTE    },    ruta_imagen="assets/images/razas/enano.png")# BRUJOBRUJO = Raza(    nombre="Brujo",    tipo=TipoRaza.BRUJO,    descripcion="Los brujos son humanos mutados genéticamente para cazar monstruos, con habilidades sobrehumanas.",    ventajas=[        VentajaRacial(            nombre="Emociones Embotadas",            descripcion="Los brujos no necesitan realizar tiradas de Coraje contra intentos de Intimidar, pero sufren un penalizador de -4 a Empatía (no puede reducir el valor por debajo de 1)",            bonificadores={"Empatía": -4},            habilidad_especial="Inmune a tiradas de Coraje vs Intimidar"        ),        VentajaRacial(            nombre="Reflejos Fulgurantes",            descripcion="Bonificador permanente de +1 a Reflejos y Destreza (puede elevar ambas características por encima de 10)",            bonificadores={"REF": 1, "DES": 1},            habilidad_especial="Puede superar 10 en REF y DES"        ),        VentajaRacial(            nombre="Sentidos Mejorados",            descripcion="No sufren penalizaciones en zonas con luz tenue. Bonificador innato de +1 a Advertir/Notar y capacidad de rastrear mediante el olfato",            bonificadores={"Advertir/Notar": 1},            habilidad_especial="Sin penaliz. luz tenue, rastrear por olfato"        ),        VentajaRacial(            nombre="Resistencia Mutante",            descripcion="Inmunes a enfermedades y pueden emplear mutágenos",            habilidad_especial="Inmune a enfermedades, puede usar mutágenos"        )    ],    estatus_social={        Territorio.EL_NORTE: EstatusSocial.ODIADO_Y_TEMIDO,        Territorio.NILFGAARD: EstatusSocial.TOLERADO_Y_TEMIDO,        Territorio.SKELLIGE: EstatusSocial.TOLERADO,        Territorio.DOL_BLATHANNA: EstatusSocial.TOLERADO,        Territorio.MAHAKAM: EstatusSocial.TOLERADO    },    ruta_imagen="assets/images/razas/brujo.png")# MEDIANOMEDIANO = Raza(    nombre="Mediano",    tipo=TipoRaza.MEDIANO,    descripcion="Los medianos son pequeños pero resistentes, con gran afinidad por la agricultura y los animales.",    ventajas=[        VentajaRacial(            nombre="Ágil",            descripcion="Bonificador innato de +1 a Atletismo",            bonificadores={"Atletismo": 1}        ),        VentajaRacial(            nombre="Resistente a la Magia",            descripcion="Bonificador innato de +5 a Resistir Magia. Pueden realizar tirada de Resistir Magia para negar efectos de conjuros que afecten a su mente incluso si normalmente no está permitida. Sin embargo, pociones de Brujo y otras pociones mágicas NO afectan positivamente a los medianos",            bonificadores={"Resistir Magia": 5},            habilidad_especial="Tirada vs hechizos mentales, pociones NO funcionan positivamente"        ),        VentajaRacial(            nombre="Mano de Granjero",            descripcion="Bonificador innato de +2 a Supervivencia cuando estén intentando calmar, domar o controlar animales",            bonificadores={"Supervivencia (animales)": 2}        )    ],    restricciones=["NO puede ser Mago", "NO puede ser Sacerdote", "NO puede ser Druida"],    estatus_social={        Territorio.EL_NORTE: EstatusSocial.TOLERADO,        Territorio.NILFGAARD: EstatusSocial.SEMEJANTE,        Territorio.SKELLIGE: EstatusSocial.TOLERADO,        Territorio.DOL_BLATHANNA: EstatusSocial.TOLERADO,        Territorio.MAHAKAM: EstatusSocial.SEMEJANTE    },    ruta_imagen="assets/images/razas/mediano.png")# GNOMOGNOMO = Raza(    nombre="Gnomo",    tipo=TipoRaza.GNOMO,    descripcion="Con su ojo para el detalle y sus excepcionales capacidades sensoriales, los gnomos son los mejores artesanos del continente. Son conocidos por ser amistosos, pícaros y aficionados a las fiestas.",    ventajas=[        VentajaRacial(            nombre="Comportamiento Agradable",            descripcion="En todo el continente, los gnomos son conocidos por su alegre y divertida personalidad y su carácter pícaro. Entre los humanos, los gnomos suelen ser considerados los más agradables de los no humanos",            bonificadores={"Carisma": 1}        ),        VentajaRacial(            nombre="Ojo para el Detalle",            descripcion="Los gnomos poseen el ojo más fino para el detalle de todo el continente. Los gnomos obtienen un +2 inherente a las 3 habilidades artesanales que elijan. Esta bonificación ignora el modificador por aprender Habilidades Difíciles.",            bonificadores={"Artesanía (3 elegidas)": 2},            habilidad_especial="Elige 3 habilidades artesanales y obtén +2 en cada una"        ),        VentajaRacial(            nombre="Rastreo de Olores",            descripcion="El agudo sentido del detalle de un gnomo se extiende a todos sus sentidos, incluido el olfato",            bonificadores={"Advertir/Notar": 1},            habilidad_especial="Puede rastrear por el olfato"        ),        VentajaRacial(            nombre="Estatura Pequeña",            descripcion="Los gnomos son la raza más pequeña del continente, con una altura media de 1 metro. Los gnomos tienen un -5 inherente a Proezas de Fuerza y recalcula su daño cuerpo a cuerpo, el daño extra a melé y el estorbo como si su TCO fuera 3 puntos inferior. Sin embargo, un gnomo puede escabullirse en cualquier área de al menos 0,5 m de ancho sin problemas y puede ocultarse completamente tras un objeto o criatura de al menos 1m por 1m",            bonificadores={"Proezas de Fuerza": -5, "TCO efectivo": -3},            habilidad_especial="Puede ocultarse tras objetos de 1m x 1m, cabe en espacios de 0.5m"        )    ],    estatus_social={        Territorio.EL_NORTE: EstatusSocial.TOLERADO,        Territorio.NILFGAARD: EstatusSocial.SEMEJANTE,        Territorio.SKELLIGE: EstatusSocial.SEMEJANTE,        Territorio.DOL_BLATHANNA: EstatusSocial.ODIADO,        Territorio.MAHAKAM: EstatusSocial.TOLERADO    },    ruta_imagen="assets/images/razas/gnomo.png")# VRANVRAN = Raza(    nombre="Vran",    tipo=TipoRaza.VRAN,    descripcion="Los vran, a veces denominados lagartos, son una de las razas más antiguas del continente. En la época anterior al Desembarco de los Exiliados, los vran eran una cultura predominante y consumada. Ahora viven como refugiados tras ser empujados al borde de la extinción.",    ventajas=[        VentajaRacial(            nombre="Corazón Tranquilo",            descripcion="Los vran tienen fama de ser criaturas sin corazón ni empatía. Sin embargo, esto está lejos de la verdad. Son mucho más reservados y menos propensos a mostrar sus emociones",            bonificadores={"Resistir Coacción": 1}        ),        VentajaRacial(            nombre="Garras y Colmillos",            descripcion="Un vran tiene dos armas naturales que no se pueden desarmar. Los puñetazos y patadas de un vran infligen daño letal y pueden realizar un ataque cuerpo a cuerpo con sus colmillos, que infligen 3d6 puntos de daño con una probabilidad del 50% de envenenar al objetivo",            habilidad_especial="Puños y patadas letales, mordisco 3d6 (50% envenenar)"        ),        VentajaRacial(            nombre="Capa de Escamas",            descripcion="Los vran poseen una capa natural de escamas que les confiere cierta resistencia natural al daño. Las escamas de un vran tienen un poder de parada natural de 4. Este CP no puede reducirse mediante ataques de arma o daño de ablación",            habilidad_especial="CP 4 natural (no reducible)"        ),        VentajaRacial(            nombre="Fisiología Reptiliana",            descripcion="Los vran son la única raza sapiente aceptada que también es reptil. Cualquier médico que no es un vran y no ha tratado con éxito a un vran en el pasado sufre un penalizador -2 al usar Primeros Auxilios en un vran herido y un penalizador -5 al intentar estabilizar o tratar Heridas Críticas. Si un vran se ve afectado por la condición congelado, sufre un penalizador -2 a todas sus acciones hasta 1d6 asaltos después de que finalice la condición",            habilidad_especial="No-vran: -2 Primeros Auxilios, -5 estabilizar/tratar críticas. Congelado: -2 todas acciones (1d6 asaltos extra)"        )    ],    estatus_social={        Territorio.EL_NORTE: EstatusSocial.ODIADO_Y_TEMIDO,        Territorio.NILFGAARD: EstatusSocial.TOLERADO_Y_TEMIDO,        Territorio.SKELLIGE: EstatusSocial.SEMEJANTE,        Territorio.DOL_BLATHANNA: EstatusSocial.ODIADO,        Territorio.MAHAKAM: EstatusSocial.TOLERADO    },    ruta_imagen="assets/images/razas/vran.png")# BOBOLACOBOBOLACO = Raza(    nombre="Bobolaco",    tipo=TipoRaza.BOBOLACO,    descripcion="Los Bobolacos son una de las Razas Antiguas menos humanoides. Son una raza orgullosa con una larga historia de heroísmo y valor. En lugar de adorar a los dioses, veneran los recuerdos de sus antepasados y los espíritus de los héroes legendarios.",    ventajas=[        VentajaRacial(            nombre="Corazón de León",            descripcion="Los Bobolacos no son la raza más numerosa del continente, pero sí una de las más valientes. Su cultura valora el heroísmo y los jóvenes escuchan historias de antiguos héroes ancestrales",            bonificadores={"Coraje": 1}        ),        VentajaRacial(            nombre="Fisiología Extraña",            descripcion="El cuerpo y el metabolismo de los Bobolacos funcionan de una manera totalmente ajena a los humanos. Cuando se les hiere gravemente, algún aspecto de su fisiología se pone en marcha. Cada vez que un Bobolaco sufre una Herida Crítica, puede realizar una tirada de Resistencia con una DO igual a la DO necesaria para Estabilizar la Herida Crítica. Si tiene éxito, la Herida Crítica se considera inmediatamente Estabilizada. Los jugadores sólo pueden hacer esta tirada en el momento en que reciben la herida y no se puede volver a intentar en caso de fallo",            habilidad_especial="Al recibir Herida Crítica: tirada de Resistencia (DO = DO estabilizar) para auto-estabilizarse"        ),        VentajaRacial(            nombre="Dientes de Navaja",            descripcion="Los Bobolacos no tienen las poderosas mandíbulas ni los colmillos venenosos de los Vran, pero sus dientes están afilados como cuchillas. Los Bobolacos pueden realizar un ataque cuerpo a cuerpo con sus colmillos que inflige 2d6 puntos de daño y tiene la habilidad Perforante mejorado",            habilidad_especial="Mordisco: 2d6 daño, Perforante mejorado"        ),        VentajaRacial(            nombre="Visión Deficiente",            descripcion="En general, los Bobolacos tienen mala vista. Aunque su agudo oído les permite navegar por el mundo sin mayores problemas, no son ni mucho menos la raza más perceptiva del continente. Los Bobolacos tienen un -4 inherente en las tiradas de Advertir/Notar debido a su mala visión. Si un Bobolaco tiene que hacer una tirada de Advertir/Notar basado sólo en el oído (como oír pasos en el piso de arriba o escuchar gruñidos de lobos) esta penalización no se aplica",            bonificadores={"Advertir/Notar": -4},            habilidad_especial="Penalización NO aplica si es solo por el oído"        )    ],    estatus_social={        Territorio.EL_NORTE: EstatusSocial.TOLERADO,        Territorio.NILFGAARD: EstatusSocial.TOLERADO,        Territorio.SKELLIGE: EstatusSocial.SEMEJANTE,        Territorio.DOL_BLATHANNA: EstatusSocial.TOLERADO,        Territorio.MAHAKAM: EstatusSocial.TOLERADO    },    ruta_imagen="assets/images/razas/bobolaco.png")# ============================================================================# DICCIONARIO DE TODAS LAS RAZAS# ============================================================================RAZAS_DISPONIBLES = {    "Humano": HUMANO,    "Elfo": ELFO,    "Enano": ENANO,    "Brujo": BRUJO,    "Mediano": MEDIANO,    "Vran": VRAN,    "Gnomo": GNOMO,    "Bobolaco": BOBOLACO}def obtener_raza(nombre: str) -> Optional[Raza]:    """Obtiene una raza por su nombre"""    return RAZAS_DISPONIBLES.get(nombre)def listar_razas() -> List[str]:    """Retorna lista de nombres de todas las razas disponibles"""    return list(RAZAS_DISPONIBLES.keys())def obtener_razas_por_territorio(territorio: Territorio) -> Dict[str, EstatusSocial]:    """Retorna diccionario de razas con su estatus social en un territorio"""    resultado = {}    for nombre, raza in RAZAS_DISPONIBLES.items():        resultado[nombre] = raza.obtener_estatus_social(territorio)    return resultado